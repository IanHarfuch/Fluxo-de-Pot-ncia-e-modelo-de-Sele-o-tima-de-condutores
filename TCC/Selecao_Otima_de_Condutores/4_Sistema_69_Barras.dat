#-------------------------------------------------------------
# Ob: conjunto de barras da rede
# Tb: tipo de barra
# PD: potencia ativa demanda
# QD: potencia reativa demanda
# QC: bancos capacitivos instalados na rede
# Tb = 1 subestac√£o (tipo de barra)
# Tb = 0 barra de carga (tipo de barra)
# as cargas estao dadas em (P=kW, Q=kVAr)

param :  Ob :  PD     Tb       QD      QC :=  
    1    0.000000     1		0.000000     0.000000
    2    0.000000     0		0.000000     0.000000
    3    0.000000     0		0.000000     0.000000
    4    0.000000     0		0.000000     0.000000
    5    0.000000     0		0.000000     0.000000
    6    2.600000     0		2.200000     0.000000
    7   40.400000	  0	    30.000000     0.000000
    8   75.000000     0   	54.000000     0.000000
    9   30.000000     0		22.000000     0.000000
   10   28.000000     0		19.000000     0.000000
   11  145.000000     0		104.000000     0.000000
   12  145.000000     0		104.000000     0.000000
   13    8.000000     0		5.500000     0.000000
   14    8.000000     0		5.500000     0.000000
   15    0.000000     0		0.000000     0.000000
   16   45.500000     0		30.000000     0.000000
   17   60.000000     0 	35.000000     0.000000
   18   60.000000     0		35.000000     0.000000
   19    0.000000     0		0.000000     0.000000
   20    1.000000     0		0.600000     0.000000
   21  114.000000     0		81.000000     0.000000
   22    5.300000     0		3.500000     0.000000
   23    0.000000     0		0.000000     0.000000
   24   28.000000     0		20.000000     0.000000
   25    0.000000     0 	0.000000     0.000000
   26   14.000000     0		10.000000     0.000000
   27   14.000000     0		10.000000     0.000000
   28   26.000000     0		18.600000     0.000000
   29   26.000000     0		18.600000     0.000000
   30    0.000000     0		0.000000     0.000000
   31    0.000000     0		0.000000     0.000000
   32    0.000000     0		0.000000     0.000000
   33   14.000000     0		10.000000     0.000000
   34   19.500000     0		14.000000     0.000000
   35    6.000000     0  	4.000000     0.000000
   36   26.000000     0		18.550000     0.000000
   37   26.000000     0		18.550000     0.000000
   38    0.000000     0		0.000000     0.000000
   39   24.000000     0		17.000000     0.000000
   40   24.000000     0		17.000000     0.000000
   41    1.200000     0		1.000000     0.000000
   42    0.000000     0		0.000000     0.000000
   43    6.000000     0		4.300000     0.000000
   44    0.000000     0		0.000000     0.000000
   45   39.220000     0		26.300000     0.000000
   46   39.220000     0		26.300000     0.000000
   47    0.000000     0		0.000000     0.000000
   48   79.000000     0		56.400000     0.000000
   49  384.700000     0		274.500000     0.000000
   50  384.700000     0		274.500000     0.000000
   51   40.500000     0		28.300000     0.000000
   52    3.600000     0  	2.700000     0.000000
   53    4.350000     0 	3.500000     0.000000
   54   26.400000     0		19.000000     0.000000
   55   24.000000     0		17.200000     0.000000
   56    0.000000     0 	0.000000     0.000000
   57    0.000000     0		0.000000     0.000000
   58    0.000000     0		0.000000     0.000000
   59  100.000000     0		72.000000     0.000000
   60    0.000000     0		0.000000     0.000000
   61 1244.000000     0		888.000000     0.000000
   62   32.000000     0		23.000000     0.000000
   63    0.000000     0		0.000000     0.000000
   64  227.000000     0		162.000000     0.000000
   65   59.000000     0		42.000000     0.000000
   66   18.000000     0		13.000000     0.000000
   67   18.000000     0		13.000000     0.000000
   68   28.000000     0		20.000000     0.000000
   69   28.000000     0		20.000000     0.000000     
         ;
		
#-----------------------------------------------------------------------

param :     Ol:   Linea	        TC        L  :=
          1    2      1         1         0.1        
          2    3      2         1         0.1        
          3    4      3         1         0.1        
          4    5      4         1         0.1        
          5    6      5         1         0.1        
          6    7      6         1         0.1        
          7    8      7         1         0.1        
          8    9      8         1         0.1        
          9   10      9         1         0.1         
         10   11     10         1         0.1         
         11   12     11         1         0.1         
         12   13     12         1         0.1         
         13   14     13         1         0.1         
         14   15     14         1         0.1         
         15   16     15         1         0.1         
         16   17     16         1         0.1         
         17   18     17         1         0.1         
         18   19     18         1         0.1         
         19   20     19         1         0.1         
         20   21     20         1         0.1         
         21   22     21         1         0.1          
         22   23     22         1         0.1          
         23   24     23         1         0.1          
         24   25     24         1         0.1          
         25   26     25         1         0.1          
         26   27     26         1         0.1          
         3    28     27         1         0.1          
         28   29     28         1         0.1          
         29   30     29         1         0.1          
         30   31     30         1         0.1          
         31   32     31         1         0.1          
         32   33     32         1         0.1          
         33   34     33         1         0.1          
         34   35     34         1         0.1          
         3    36     35         1         0.1         
         36   37     36         1         0.1         
         37   38     37         1         0.1         
         38   39     38         1         0.1         
         39   40     39         1         0.1         
         40   41     40         1         0.1          
         41   42     41         1         0.1          
         42   43     42         1         0.1          
         43   44     43         1         0.1          
         44   45     44         1         0.1          
         45   46     45         1         0.1          
         4    47     46         1         0.1         
         47   48     47         1         0.1         
         48   49     48         1         0.1
         49   50     49         1         0.1         
         8    51     50         1         0.1          
         51   52     51         1         0.1          
         9    53     52         1         0.1        
         53   54     53         1         0.1        
         54   55     54         1         0.1        
         55   56     55         1         0.1        
         56   57     56         1         0.1        
         57   58     57         1         0.1        
         58   59     58         1         0.1        
         59   60     59         1         0.1        
         60   61     60         1         0.1        
         61   62     61         1         0.1         
         62   63     62         1         0.1         
         63   64     63         1         0.1         
         64   65     64         1         0.1          
         11   66     65         1         0.1
         66   67     66         1         0.1          
         12   68     67         1         0.1
         68   69     68         1         0.1          
        ;
    	 
#-------------------------------------------------------------

param:		Oc:		  Rc			Xc	  	Icmax		Cc:=
			1       0.2128   	0.30747     	760	    	276892.60000		
            2       0.2128   	0.30747     	546     	99681.33600            
            3       0.5424   	0.78370     	440     	42602.77458              
            4       0.4545   	0.98290     	380     	27083.73717               
            5       0.7220   	1.06880     	330     	17067.77412
            6       0.7741   	1.10700     	245     	6747.15401
            7       0.8570   	1.16640     	215     	4236.96745
            8       0.9361   	1.25330     	135     	1056.63914
            9       0.9746   	1.33220     	105     	1629.60000
            10       0.9920   	1.35000     	81      	1088.64000
            11       1.1270   	1.51740     	70      	733.60000
            12       1.2620   	1.73340     	48      	243.20734
            13       1.4336   	2.52260     	31      	2288.35272
        ;          	 
    	 
#------------------------------------------------------------
#- Dados das Tensoes -#

let Vnom := 12.66;		#Tensao da rede em kV
let Vmin := 0.95 * Vnom;		#Tensao minima
let Vmax := 1.0 * Vnom;		#Tensao maxima
let T := 8760;
let LSF := 0.2;
let Kp := 1.04;
let IDF := 0.1;
let Ke := 0.012;

  
#------------------------------------------------------------

for {c in Oc}
{
	let Rc[c]	:=	Rc[c]/1000; #Transforma Ohm em kOhm
	let Xc[c]	:=	Xc[c]/1000;
	let Z2[c]	:=	Rc[c]^2 + Xc[c]^2; #C·lculo de Z^2 
}

#-------------------------------------------------------------
#- Fixar a potencia ativa e reativa das barras -#

fix{i in Ob: Tb[i] == 0}
	PS[i] := 0;
	
fix{i in Ob: Tb[i] == 0}
	QS[i] := 0;
	 
#- Fixar a tensao na subestacao -#
fix{i in Ob: Tb[i] == 1}
	Vsqr[i] := Vnom^2;
	
#------------------------------------------------------------


# Linearizacao
for{(i,j) in Ol}{
	let DS[i,j] := (Vmax * Icmax[1]) / Y;

	for {y in 1..Y}{
		let ms[i,j,y] := (2*y-1)*DS[i,j];
	}
	let ms[i,j,1] := ms[i,j,1] * 5/6;
}
	