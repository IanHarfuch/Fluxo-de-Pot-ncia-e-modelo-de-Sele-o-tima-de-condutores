
#-------------------------------------------------------------
# Ob: conjunto de barras da rede
# Tb: tipo de barra
# PD: potencia ativa demanda
# QD: potencia reativa demanda
# QC: bancos capacitivos instalados na rede
# Tb = 1 subestac√£o (tipo de barra)
# Tb = 0 barra de carga (tipo de barra)
# as cargas estao dadas em (P=kW, Q=kVAr)

#-----------------------------------------------------------------------
# Sistema de 85 barras


 
#-----------------------------------------------------------------------
 
param :   Ob :		Tb      PD           QD       QC :=
               0     1      0.0      0.0     0
               1     0      0.0      0.0     0
               2     0    100.0     50.0     0
               3     0    300.0    200.0     0
               4     0    350.0    250.0     0
               5     0    220.0    100.0     0
               6     0   1100.0    800.0     0
               7     0    400.0    320.0     0
               8     0    300.0    200.0     0
               9     0    300.0    230.0     0
               10    0    300.0    260.0     0
               11    0      0.9      0.0     0
               12    0   1200.0    800.0     0
               13    0    800.0    600.0     0
               14    0    700.0    500.0     0
               15    0      0.0      0.0     0
               16    0    300.0    150.0     0
               17    0    500.0    350.0     0
               18    0    700.0    400.0     0
               19    0   1200.0   1000.0     0
               20    0    300.0    300.0     0
               21    0    400.0    350.0     0
               22    0     50.0     20.0     0
               23    0     50.0     20.0     0
               24    0     50.0     10.0     0
               25    0     50.0     30.0     0
               26    0    100.0     60.0     0
               27    0    100.0     70.0     0
               28    0   1800.0   1300.0     0
               29    0    200.0    120.0     0
               30    0      0.0      0.0     0
               31    0   1800.0   1600.0     0
               32    0    200.0    150.0     0
               33    0    200.0    100.0     0
               34    0    800.0    600.0     0
               35    0    100.0     60.0     0
               36    0    100.0     60.0     0
               37    0     20.0     10.0     0
               38    0     20.0     10.0     0
               39    0     20.0     10.0     0
               40    0     20.0     10.0     0
               41    0    200.0    160.0     0
               42    0     50.0     30.0     0
               43    0      0.0      0.0     0
               44    0     30.0     20.0     0
               45    0    800.0    700.0     0
               46    0    200.0    150.0     0
               47    0      0.0      0.0     0
               48    0      0.0      0.0     0
               49    0      0.0      0.0     0
               50    0    200.0    160.0     0
               51    0    800.0    600.0     0
               52    0    500.0    300.0     0
               53    0    500.0    350.0     0
               54    0    500.0    300.0     0
               55    0    200.0     80.0     0
               56    0      0.0      0.0     0
               57    0     30.0     20.0     0
               58    0    600.0    420.0     0
               59    0      0.0      0.0     0
               60    0     20.0     10.0     0
               61    0     20.0     10.0     0
               62    0    200.0    130.0     0
               63    0    300.0    240.0     0
               64    0    300.0    200.0     0
               65    0      0.0      0.0     0
               66    0     50.0     30.0     0
               67    0      0.0      0.0     0
               68    0    400.0    360.0     0
               69    0      0.0      0.0     0
               70    0      0.0      0.0     0
               71    0   2000.0   1500.0     0
               72    0    200.0    150.0     0
               73    0      0.0      0.0     0
               74    0      0.0      0.0     0
               75    0   1200.0    950.0     0
               76    0    300.0    180.0     0
               77    0      0.0      0.0     0
               78    0   400.0    360.0     0
               79    0   2000.0   1300.0     0
               80    0    200.0    140.0     0
               81    0    500.0    360.0     0
               82    0    100.0     30.0     0
               83    0    400.0    360.0     0  ;
       
      

#-----------------------------------------------------------------------
# Datos lineas 

param :     Ol:         R   		  X   	       Imax :=
		0       1       1     0.1944      0.6624      1000
		1       2       2     0.2096      0.4304      1000
		2       3       3     0.2358      0.4842      1000
		3       4       4     0.0917      0.1883      1000
		4       5       5     0.2096      0.4304      1000
		5       6       6     0.0393      0.0807      1000
		6       7       7     0.0405      0.1380      1000
		7       8       8     0.1048      0.2152      1000
		7       9       9     0.2358      0.4842      1000
		7      10      10     0.1048      0.2152      1000
		0      11      11     0.0786      0.1614      1000
		11     12      12     0.3406      0.6944      1000
		12     13      13     0.0262      0.0538      1000
		12     14      14     0.0786      0.1614      1000
		0      15      15     0.1134      0.3864      1000
		15     16      16     0.0524      0.1076      1000
		16     17      17     0.0524      0.1076      1000
		17     18      18     0.1572      0.3228      1000
		18     19      19     0.0393      0.0807      1000
		19     20      20     0.1703      0.3497      1000
		20     21      21     0.2358      0.4842      1000
		21     22      22     0.1572      0.3228      1000
		21     23      23     0.1965      0.4035      1000
		23     24      24     0.1310      0.2690      1000
		0      25      25     0.0567      0.1932      1000
		25     26      26     0.1048      0.2152      1000
		26     27      27     0.2489      0.5111      1000
		27     28      28     0.0486      0.1656      1000
		28     29      29     0.1310      0.2690      1000
		0      30      30     0.1965      0.3960      1000
		30     31      31     0.1310      0.2690      1000
		31     32      32     0.1310      0.2690      1000
		32     33      33     0.0262      0.0538      1000
		33     34      34     0.1703      0.3497      1000
		34     35      35     0.0524      0.1076      1000
		35     36      36     0.4978      1.0222      1000
		36     37      37     0.0393      0.0807      1000
		37     38      38     0.0393      0.0807      1000
		38     39      39     0.0786      0.1614      1000
		39     40      40     0.2096      0.4304      1000
		38     41      41     0.1965      0.4035      1000
		41     42      42     0.2096      0.4304      1000
		0      43      43     0.0486      0.1656      1000
		43     44      44     0.0393      0.0807      1000
		44     45      45     0.1310      0.2690      1000
		45     46      46     0.2358      0.4842      1000
		0      47      47     0.2430      0.8280      1000
		47     48      48     0.0655      0.1345      1000
		48     49      49     0.0655      0.1345      1000
		49     50      50     0.0393      0.0807      1000
		50     51      51     0.0786      0.1614      1000
		51     52      52     0.0393      0.0807      1000
		52     53      53     0.0786      0.1614      1000
		53     54      54     0.0524      0.1076      1000
		54     55      55     0.1310      0.2690      1000
		0      56      56     0.2268      0.7728      1000
		56     57      57     0.5371      1.1029      1000
		57     58      58     0.0524      0.1076      1000
		58     59      59     0.0405      0.1380      1000
		59     60      60     0.0393      0.0807      1000
		60     61      61     0.0262      0.0538      1000
		61     62      62     0.1048      0.2152      1000
		62     63      63     0.2358      0.4842      1000
		63     64      64     0.0243      0.0828      1000
		0      65      65     0.0486      0.1656      1000
		65     66      66     0.1703      0.3497      1000
		66     67      67     0.1215      0.4140      1000
		67     68      68     0.2187      0.7452      1000
		68     69      69     0.0486      0.1656      1000
		69     70      70     0.0729      0.2484      1000
		70     71      71     0.0567      0.1932      1000
		71     72      72     0.0262      0.0528      1000
		0      73      73     0.3240      1.1040      1000
		73     74      74     0.0324      0.1104      1000
		74     75      75     0.0567      0.1932      1000
		75     76      76     0.0486      0.1656      1000
		0      77      77     0.2511      0.8556      1000
		77     78      78     0.1296      0.4416      1000
		78     79      79     0.0486      0.1656      1000
		79     80      80     0.1310      0.2640      1000
		80     81      81     0.1310      0.2640      1000
		81     82      82     0.0917      0.1883      1000
		82     83      83     0.3144      0.6456      1000	;
           


#- Dados das Tensoes -#

let Vnom := 11;		#Tensao da rede em kV
let Vmin := 0.9 * Vnom;		#Tensao minima
let Vmax := 1.0 * Vnom;		#Tensao maxima
  
#------------------------------------------------------------

for {(i,j) in Ol}
{
	let R[i,j]	:=	R[i,j]/1000; #Transforma Ohm em kOhm
	let X[i,j]	:=	X[i,j]/1000;
	let Z2[i,j]	:=	R[i,j]^2 + X[i,j]^2; #C·lculo de Z^2 
}

#-------------------------------------------------------------
#- Fixar a potencia ativa e reativa das barras -#

fix{i in Ob: Tb[i] == 0}
	PS[i] := 0;
	
fix{i in Ob: Tb[i] == 0}
	QS[i] := 0;
	 
#- Fixar a tensao na subestacao -#
fix{i in Ob: Tb[i] == 1}
	Vsqr[i] := Vnom^2;
	
#------------------------------------------------------------


# Linearizacao
for{(i,j) in Ol}{
	let DS[i,j] := (Vmax * Imax[i,j]) / Y;

	for {y in 1..Y}{
		let ms[i,j,y] := (2*y-1)*DS[i,j];
	}
	let ms[i,j,1] := ms[i,j,1] * 5/6;
}




